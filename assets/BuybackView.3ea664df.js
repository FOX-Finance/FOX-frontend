import{_ as O,B as r,p as m,g as k,a as V,c as T,b as _,d as E,e as X,o as l,f as a,h as v,i as t,w as c,v as W,F,r as L,j as h,k as p,l as R,m as S,t as f,n as A,q as B,s as H,u as z,x as g,y as b,z as w,A as M,C as x,D as y,E as C}from"./index.bd54017c.js";const I={data(){return{connected:!1,approval_foxs:!1,approval_fox:!1,tokenIds:[],cdp:"",foxs:r.from("0"),weth:r.from("0"),ltv:0,fox_format:"",weth_format:"",foxs_format:""}},computed:{formattedWETH:{get(){return this.weth_format===""?"":this.weth_format},set(e){let o=e.toString();this.weth_format=o,o===""&&(o="0"),this.weth=m(o,"ether")}},formattedLTV:{get(){return this.ltv===""?"":+(this.ltv/100).toFixed(2)},set(e){this.ltv=+(+e.toFixed(2)*100).toFixed(2)}},formattedFOXS:{get(){return this.foxs_format===""?"":this.foxs_format},set(e){let o=e.toString();this.foxs_format=o,o===""&&(o="0"),this.foxs=m(o,"ether")}}},mounted(){try{this.updateValues(),this.checkAllowance()}catch{}this.emitter.on("metamask-connect-event",e=>{this.connected=e,this.connected&&(this.updateValues(),this.checkAllowance())}),p()!==""&&(this.connected=!0)},methods:{checkAllowance:function(){k("FOXS").then(e=>{e!=0&&(this.approval_foxs=!0,k("FOX").then(o=>{o!=0&&(this.approval_fox=!0)}))})},updateValues:function(){V("FOXFARM").then(e=>{this.tokenIds=e})},connectOnClick:function(){console.log("connected : ",this.connected),!(p()!==""||this.connected)&&T().then(e=>{e?(console.log("metamask successfully connected!"),this.emitter.emit("metamask-connect-event",!0)):(console.log("metamask connection failed!"),this.emitter.emit("metamask-connect-event",!1))})},approveOnClick:function(){console.log("approveOnClick (approval_foxs) : ",this.approval_foxs),this.approval_foxs?this.approval_fox||(this.emitter.emit("loading-event",!0),_("FOX").then(e=>{this.emitter.emit("loading-event",!1),e?this.approval_fox=!0:this.approval_fox=!1})):(this.emitter.emit("loading-event",!0),_("FOXS").then(e=>{this.emitter.emit("loading-event",!1),e?this.approval_foxs=!0:this.approval_foxs=!1}))},buybackOnClick:function(){this.emitter.emit("loading-event",!0),E(this.cdp,this.foxs).then(e=>{this.emitter.emit("loading-event",!1),console.log(e?"buyback success!":"buyback failed!")})},changeCDP:function(){},inputFOXS:function(){X(this.cdp,this.foxs,this.ltv).then(e=>{this.weth=e})},inputLTV:function(){this.inputFOXS()}}},D={class:"uk-width-1-1"},U={key:0,class:"wallet-outer uk-width-1-1"},P=t("div",{class:"wallet-inner"},[t("span",{"uk-icon":"icon: more; ratio: 3"}),t("p",null,"Please connect to wallet")],-1),N=[P],G={class:"uk-width-1-1"},j=t("hr",null,null,-1),q={class:"uk-inline form-icon"},J={"uk-form-custom":"target: > button > span:first-child",style:{"padding-left":"0px","padding-right":"0px"}},K=t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon"},[t("span",null,"CDP#")],-1),Q=["disabled"],Y=["value"],Z=t("button",{class:"uk-button uk-button-grey form-button uk-form-width-medium uk-form-large uk-text-left",type:"button",tabindex:"-1",style:{"max-width":"100%"}},[t("span"),t("span",{"uk-icon":"icon: chevron-down",style:{float:"right",position:"relative",right:"95px",top:"17px"}})],-1),$=t("div",{class:"wrap"},[t("span",{class:"icon-circle","uk-icon":"icon: arrow-down; ratio: 1.5;"})],-1),tt={class:"uk-inline form-icon"},et=t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon"},[t("img",{src:R,style:{width:"20px"}}),t("span",null,"FOXS")],-1),ot=["disabled"],nt=t("div",{class:"wrap"},[t("span",{class:"icon-circle","uk-icon":"icon: arrow-down; ratio: 1.5;"})],-1),st={class:"uk-inline form-icon"},it=t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon"},[t("img",{src:S,style:{width:"20px"}}),t("span",null,"FIL")],-1),lt={class:"wrap"},at={class:"uk-inline"},rt=t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon"},[t("span",null,"LTV(%)")],-1),ut=["disabled"],ct=t("hr",null,null,-1),dt={key:0},ht={key:1},ft={key:0},mt={key:1},pt={key:2};function kt(e,o,u,d,i,s){return l(),a("div",D,[i.connected?v("",!0):(l(),a("div",U,N)),t("div",G,[j,t("div",q,[t("div",J,[K,c(t("select",{"onUpdate:modelValue":o[0]||(o[0]=n=>i.cdp=n),"aria-label":"Custom controls",class:"form-button uk-form-width-medium uk-form-large",onChange:o[1]||(o[1]=(...n)=>s.changeCDP&&s.changeCDP(...n)),disabled:!i.connected},[(l(!0),a(F,null,L(i.tokenIds,n=>(l(),a("option",{key:n,value:n},f(n),9,Y))),128))],40,Q),[[W,i.cdp]]),Z])]),$,t("div",tt,[et,c(t("input",{class:"uk-input input-form uk-form-width-medium uk-form-large",type:"number","onUpdate:modelValue":o[2]||(o[2]=n=>s.formattedFOXS=n),onInput:o[3]||(o[3]=(...n)=>s.inputFOXS&&s.inputFOXS(...n)),disabled:i.cdp===""},null,40,ot),[[h,s.formattedFOXS]])]),nt,t("div",st,[it,c(t("input",{readonly:"",class:"uk-input result-form uk-form-width-medium uk-form-large",type:"number","onUpdate:modelValue":o[4]||(o[4]=n=>s.formattedWETH=n)},null,512),[[h,s.formattedWETH]])]),t("div",lt,[t("div",at,[rt,c(t("input",{class:"uk-input input-form uk-form-width-medium uk-form-large",type:"number","onUpdate:modelValue":o[5]||(o[5]=n=>s.formattedLTV=n),onInput:o[6]||(o[6]=(...n)=>s.inputLTV&&s.inputLTV(...n)),disabled:i.cdp===""},null,40,ut),[[h,s.formattedLTV]])])]),ct,i.approval_foxs&&i.approval_fox?(l(),a("div",dt,[t("button",{class:"uk-button uk-button-default uk-button-large form-button",onClick:o[7]||(o[7]=(...n)=>s.buybackOnClick&&s.buybackOnClick(...n))}," Buyback ")])):i.connected?(l(),a("div",ht,[t("button",{class:"uk-button uk-button-default uk-button-large form-button",onClick:o[8]||(o[8]=(...n)=>s.approveOnClick&&s.approveOnClick(...n))},[i.approval_foxs?i.approval_fox?v("",!0):(l(),a("span",mt,"Approve(FOX)")):(l(),a("span",ft,"Approve(FOXS)"))])])):(l(),a("div",pt,[t("button",{class:"uk-button uk-button-default uk-button-large form-button",onClick:o[9]||(o[9]=(...n)=>s.connectOnClick&&s.connectOnClick(...n))}," Connect Wallet ")]))])])}const _t=O(I,[["render",kt]]),vt={data(){return{connected:!1,approval_weth:!1,tokenIds:[],cdp:"",weth:r.from("0"),ltv:0,foxs:r.from("0"),weth_format:"",foxs_format:"",bWethWrongRange:!1,bLtvWrongRange:!1,trustLevel:0,maxLTV:0}},computed:{formattedWETH:{get(){return this.weth_format===""?"":this.weth_format},set(e){let o=e.toString();this.weth_format=o,o===""&&(o="0"),this.weth=m(o,"ether")}},formattedLTV:{get(){return this.ltv===""?"":+(this.ltv/100).toFixed(2)},set(e){console.log("set ltv!!",e),this.ltv=+(+e.toFixed(2)*100).toFixed(2)}},formattedFOXS:{get(){return this.foxs_format===""?"":this.foxs_format},set(e){let o=e.toString();this.foxs_format=o,o===""&&(o="0"),this.foxs=m(o,"ether")}}},mounted(){try{this.updateValues(),this.checkAllowance()}catch{}this.emitter.on("metamask-connect-event",e=>{this.connected=e,this.connected&&(this.updateValues(),this.checkAllowance())}),p()!==""&&(this.connected=!0)},methods:{checkAllowance:function(){k("WETH").then(e=>{e!=0&&(this.approval_weth=!0)})},updateValues:function(){A().then(e=>{this.trustLevel=+(e/100).toFixed(2)}),B().then(e=>{this.maxLTV=+(e/100).toFixed(2)}),V("FOXFARM").then(e=>{this.tokenIds=e})},connectOnClick:function(){console.log("connected : ",this.connected),!(p()!==""||this.connected)&&T().then(e=>{e?(console.log("metamask successfully connected!"),this.emitter.emit("metamask-connect-event",!0)):(console.log("metamask connection failed!"),this.emitter.emit("metamask-connect-event",!1))})},approveOnClick:function(){this.approval_weth||(this.emitter.emit("loading-event",!0),_("WETH").then(e=>{this.emitter.emit("loading-event",!1),e?this.approval_weth=!0:this.approval_weth=!1}))},RecollateralizeOnClick:function(){this.emitter.emit("loading-event",!0),H(this.cdp,this.weth,this.ltv).then(e=>{this.emitter.emit("loading-event",!1),console.log(e?"recollateralize success!":"recollateralize failed!")})},changeCDP:function(){z(this.cdp).then(e=>{this.setWETH(e.collateralAmount_),this.ltv=e.ltv_,this.setFOXS(e.shareAmount_)})},setWETH:function(e){this.weth=r.from(e),this.weth_format=g(r.from(e))},setFOXS:function(e){this.foxs=r.from(e),this.foxs_format=g(r.from(e))},updateMaxWethOnClick:async function(){this.updateMaxWETH().then(e=>{this.inputWETH()})},updateMaxLtvOnClick:async function(){this.updateMaxLTV().then(e=>{this.inputLTV()})},updateMaxWETH:async function(){return b(this.cdp,this.ltv).then(e=>{this.setWETH(e.upperBound_)})},updateMaxLTV:async function(){return w(this.cdp,this.weth).then(e=>{this.ltv=e.upperBound_})},inputWETH:async function(e){this.updateFoxs().then(o=>{this.checkRange(e)})},inputLTV:async function(e){this.updateFoxs().then(o=>{this.checkRange(e)})},updateFoxs:async function(){return M(this.cdp,this.weth,this.ltv).then(e=>{console.log("getShareAmountInRecollateralize",e),this.setFOXS(r.from(e))})},checkRange:async function(e){b(this.cdp,this.ltv).then(o=>{let u=r.from(o.upperBound_),d=r.from(o.lowerBound_);this.bWethWrongRange=e!==void 0&&parseInt(e.target.value)<0||this.weth.gt(u)||this.weth.lt(d),console.log(this.bWethWrongRange,"WETH RANGE!!! ",u,d)}),w(this.cdp,this.weth).then(o=>{let u=o.upperBound_,d=o.lowerBound_;this.bLtvWrongRange=e!==void 0&&parseInt(e.target.value)<0||this.ltv>u||this.ltv<d,console.log(this.bLtvWrongRange,"LTV RANGE!!! ",u,d,this.ltv)})}}},gt={class:"uk-width-1-1"},bt={key:0,class:"wallet-outer uk-width-1-1"},wt=t("div",{class:"wallet-inner"},[t("span",{"uk-icon":"icon: more; ratio: 3"}),t("p",null,"Please connect to wallet")],-1),xt=[wt],yt={class:"uk-width-1-1"},Ct=t("hr",null,null,-1),Ot={class:"uk-inline form-icon"},Vt={"uk-form-custom":"target: > button > span:first-child",style:{"padding-left":"0px","padding-right":"0px"}},Tt=t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon"},[t("span",null,"CDP#")],-1),Wt=["disabled"],Ft=["value"],Lt=t("button",{class:"uk-button uk-button-grey form-button uk-form-width-medium uk-form-large uk-text-left",type:"button",tabindex:"-1",style:{"max-width":"100%"}},[t("span"),t("span",{"uk-icon":"icon: chevron-down",style:{float:"right",position:"relative",right:"95px",top:"17px"}})],-1),Rt=t("div",{class:"wrap"},[t("span",{class:"icon-circle","uk-icon":"icon: arrow-down; ratio: 2;",style:{"margin-left":"-1px"}})],-1),St={class:"uk-inline form-icon"},Et=t("img",{src:S,style:{width:"20px"}},null,-1),Xt=t("span",null,"FIL",-1),At=[Et,Xt],Bt=["disabled"],Ht={class:"wrap"},zt={class:"uk-inline"},Mt=t("span",null,"LTV(%)",-1),It=[Mt],Dt=["disabled"],Ut={key:0,class:"description"},Pt=t("span",{style:{"font-weight":"bold",color:"red"}},"WRONG VALUE!",-1),Nt=[Pt],Gt={key:1,class:"description"},jt=t("span",{style:{"font-weight":"bold"}},"MAX LTV:",-1),qt=t("hr",{class:"custom-divider-vertical"},null,-1),Jt={class:"description"},Kt=t("span",{style:{"font-weight":"bold"}},"TRUST LEVEL:",-1),Qt=t("div",{class:"wrap"},[t("span",{class:"icon-circle","uk-icon":"icon: arrow-down; ratio: 2;",style:{"margin-left":"-1px"}})],-1),Yt={class:"uk-inline form-icon"},Zt=t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon"},[t("img",{src:R,style:{width:"20px"}}),t("span",null,"FOXS")],-1),$t=t("hr",null,null,-1),te={key:2},ee={key:3},oe={key:4};function ne(e,o,u,d,i,s){return l(),a("div",gt,[i.connected?v("",!0):(l(),a("div",bt,xt)),t("div",yt,[Ct,t("div",Ot,[t("div",Vt,[Tt,c(t("select",{"onUpdate:modelValue":o[0]||(o[0]=n=>i.cdp=n),"aria-label":"Custom controls",class:"form-button uk-form-width-medium uk-form-large",onChange:o[1]||(o[1]=(...n)=>s.changeCDP&&s.changeCDP(...n)),disabled:!i.connected},[(l(!0),a(F,null,L(i.tokenIds,n=>(l(),a("option",{key:n,value:n},f(n),9,Ft))),128))],40,Wt),[[W,i.cdp]]),Lt])]),Rt,t("div",St,[t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon",onClick:o[2]||(o[2]=n=>s.updateMaxWethOnClick())},At),c(t("input",{class:x(["uk-input input-form uk-form-width-medium uk-form-large",{wrong:i.bWethWrongRange}]),type:"number",min:"0","onUpdate:modelValue":o[3]||(o[3]=n=>s.formattedWETH=n),onInput:o[4]||(o[4]=n=>s.inputWETH(n)),disabled:i.cdp===""},null,42,Bt),[[h,s.formattedWETH]])]),t("div",Ht,[t("div",zt,[t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon",onClick:o[5]||(o[5]=n=>s.updateMaxLtvOnClick())},It),c(t("input",{class:x(["uk-input input-form uk-form-width-medium uk-form-large",{wrong:i.bLtvWrongRange}]),type:"number","onUpdate:modelValue":o[6]||(o[6]=n=>s.formattedLTV=n),onInput:o[7]||(o[7]=n=>s.inputLTV(n)),disabled:i.cdp===""},null,42,Dt),[[h,s.formattedLTV]])])]),i.bWethWrongRange||i.bLtvWrongRange?(l(),a("div",Ut,Nt)):(l(),a("div",Gt,[jt,y(" "+f(this.maxLTV)+"% ",1)])),qt,t("div",Jt,[Kt,y(" "+f(this.trustLevel)+"% ",1)]),Qt,t("div",Yt,[Zt,c(t("input",{readonly:"",class:"uk-input result-form uk-form-width-medium uk-form-large",type:"number","onUpdate:modelValue":o[8]||(o[8]=n=>s.formattedFOXS=n)},null,512),[[h,s.formattedFOXS]])]),$t,i.approval_weth?(l(),a("div",te,[t("button",{class:"uk-button uk-button-default uk-button-large form-button",onClick:o[9]||(o[9]=(...n)=>s.RecollateralizeOnClick&&s.RecollateralizeOnClick(...n))}," Recollateralize ")])):i.connected?(l(),a("div",ee,[t("button",{class:"uk-button uk-button-default uk-button-large form-button",onClick:o[10]||(o[10]=(...n)=>s.approveOnClick&&s.approveOnClick(...n))}," Approve(WETH) ")])):(l(),a("div",oe,[t("button",{class:"uk-button uk-button-default uk-button-large form-button",onClick:o[11]||(o[11]=(...n)=>s.connectOnClick&&s.connectOnClick(...n))}," Connect Wallet ")]))])])}const se=O(vt,[["render",ne]]),ie={class:"width-1-1-medium"},le={class:"uk-card uk-card-default"},ae=t("ul",{class:"uk-flex-center","uk-tab":"","data-uk-tab":"{connect:'#buyback-tab-contents'}"},[t("li",{class:"uk-active"},[t("a",null,"Buyback")]),t("li",null,[t("a",null,"Recollateralize")])],-1),re={id:"buyback-tab-contents",class:"uk-switcher"},ce={__name:"BuybackView",setup(e){return(o,u)=>(l(),a("div",ie,[t("div",le,[t("div",null,[ae,t("ul",re,[t("li",null,[C(_t)]),t("li",null,[C(se)])])])])]))}};export{ce as default};
