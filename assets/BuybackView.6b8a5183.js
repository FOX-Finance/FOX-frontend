import{_ as W,B as r,p,g as v,a as L,c as F,b as g,d as B,e as H,o as l,f as a,h as b,i as t,w as d,v as R,F as S,r as E,t as m,j as h,k,l as X,m as A,n as z,q as M,s as I,u as D,x as w,y as x,z as y,A as U,C,D as V,E as T,G as f,H as O}from"./index.15419f81.js";const P={data(){return{connected:!1,approval_foxs:!1,approval_fox:!1,tokenIds:[],cdp:"",foxs:r.from("0"),weth:r.from("0"),ltv:0,fox_format:"",weth_format:"",foxs_format:""}},computed:{formattedWETH:{get(){return this.weth_format===""?"":this.weth_format},set(e){let o=e.toString();this.weth_format=o,o===""&&(o="0"),this.weth=p(o,"ether")}},formattedLTV:{get(){return this.ltv===""?"":+(this.ltv/100).toFixed(2)},set(e){this.ltv=+(+e.toFixed(2)*100).toFixed(2)}},formattedFOXS:{get(){return this.foxs_format===""?"":this.foxs_format},set(e){let o=e.toString();this.foxs_format=o,o===""&&(o="0"),this.foxs=p(o,"ether")}}},mounted(){try{this.updateValues(),this.checkAllowance()}catch{}this.emitter.on("metamask-connect-event",e=>{this.connected=e,this.connected&&(this.updateValues(),this.checkAllowance())}),k()!==""&&(this.connected=!0)},methods:{checkAllowance:function(){v("FOXS").then(e=>{e!=0&&(this.approval_foxs=!0,v("FOX").then(o=>{o!=0&&(this.approval_fox=!0)}))})},updateValues:function(){L().then(e=>{this.tokenIds=e})},connectOnClick:function(){console.log("connected : ",this.connected),!(k()!==""||this.connected)&&F().then(e=>{e?(console.log("metamask successfully connected!"),this.emitter.emit("metamask-connect-event",!0)):(console.log("metamask connection failed!"),this.emitter.emit("metamask-connect-event",!1))})},approveOnClick:async function(){if(console.log("approveOnClick (approval_foxs) : ",this.approval_foxs),this.approval_foxs){if(!this.approval_fox){this.emitter.emit("loading-event",!0);try{await g("FOX")?this.approval_fox=!0:this.approval_fox=!1}catch{}finally{this.emitter.emit("loading-event",!1)}}}else{this.emitter.emit("loading-event",!0);try{await g("FOXS")?this.approval_foxs=!0:this.approval_foxs=!1}catch{}finally{this.emitter.emit("loading-event",!1)}}},buybackOnClick:async function(){this.emitter.emit("loading-event",!0);try{const e=await B(this.cdp,this.foxs);console.log(e?"buyback success!":"buyback failed!")}catch{}finally{this.emitter.emit("loading-event",!1)}},changeCDP:function(){},inputFOXS:function(){H(this.cdp,this.foxs,this.ltv).then(e=>{this.weth=e})},inputLTV:function(){this.inputFOXS()}}},N={class:"uk-width-1-1"},G={key:0,class:"wallet-outer uk-width-1-1"},K=t("div",{class:"wallet-inner"},[t("span",{"uk-icon":"icon: more; ratio: 3"}),t("p",null,"Please connect to wallet")],-1),j=[K],q={class:"uk-width-1-1"},J=t("hr",null,null,-1),Q={class:"uk-inline form-icon"},Y={"uk-form-custom":"target: > button > span:first-child",style:{"padding-left":"0px","padding-right":"0px"}},Z=t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon"},[t("span",null,"CDP#")],-1),$=["disabled"],tt=["value"],et=t("button",{class:"uk-button uk-button-grey form-button uk-form-width-medium uk-form-large uk-text-left",type:"button",tabindex:"-1",style:{"max-width":"100%"}},[t("span"),t("span",{"uk-icon":"icon: chevron-down",style:{float:"right",position:"relative",right:"95px",top:"17px"}})],-1),ot=t("div",{class:"wrap"},[t("span",{class:"icon-circle","uk-icon":"icon: arrow-down; ratio: 1.5;"})],-1),nt={class:"uk-inline form-icon"},st=t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon"},[t("img",{src:X,style:{width:"20px"}}),t("span",null,"FOXS")],-1),it=["disabled"],lt=t("div",{class:"wrap"},[t("span",{class:"icon-circle","uk-icon":"icon: arrow-down; ratio: 1.5;"})],-1),at={class:"uk-inline form-icon"},rt=t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon"},[t("img",{src:A,style:{width:"20px"}}),t("span",null,"FIL")],-1),ct={class:"wrap"},ut={class:"uk-inline"},dt=t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon"},[t("span",null,"LTV(%)")],-1),ht=["disabled"],ft=t("hr",null,null,-1),mt={key:0},pt={key:1},kt={key:0},_t={key:1},vt={key:2};function gt(e,o,u,c,i,s){return l(),a("div",N,[i.connected?b("",!0):(l(),a("div",G,j)),t("div",q,[J,t("div",Q,[t("div",Y,[Z,d(t("select",{"onUpdate:modelValue":o[0]||(o[0]=n=>i.cdp=n),"aria-label":"Custom controls",class:"form-button uk-form-width-medium uk-form-large",onChange:o[1]||(o[1]=(...n)=>s.changeCDP&&s.changeCDP(...n)),disabled:!i.connected},[(l(!0),a(S,null,E(i.tokenIds,n=>(l(),a("option",{key:n,value:n},m(n),9,tt))),128))],40,$),[[R,i.cdp]]),et])]),ot,t("div",nt,[st,d(t("input",{class:"uk-input input-form uk-form-width-medium uk-form-large",type:"number","onUpdate:modelValue":o[2]||(o[2]=n=>s.formattedFOXS=n),onInput:o[3]||(o[3]=(...n)=>s.inputFOXS&&s.inputFOXS(...n)),disabled:i.cdp===""},null,40,it),[[h,s.formattedFOXS]])]),lt,t("div",at,[rt,d(t("input",{readonly:"",class:"uk-input result-form uk-form-width-medium uk-form-large",type:"number","onUpdate:modelValue":o[4]||(o[4]=n=>s.formattedWETH=n)},null,512),[[h,s.formattedWETH]])]),t("div",ct,[t("div",ut,[dt,d(t("input",{class:"uk-input input-form uk-form-width-medium uk-form-large",type:"number","onUpdate:modelValue":o[5]||(o[5]=n=>s.formattedLTV=n),onInput:o[6]||(o[6]=(...n)=>s.inputLTV&&s.inputLTV(...n)),disabled:i.cdp===""},null,40,ht),[[h,s.formattedLTV]])])]),ft,i.approval_foxs&&i.approval_fox?(l(),a("div",mt,[t("button",{class:"uk-button uk-button-default uk-button-large form-button",onClick:o[7]||(o[7]=(...n)=>s.buybackOnClick&&s.buybackOnClick(...n))}," Buyback ")])):i.connected?(l(),a("div",pt,[t("button",{class:"uk-button uk-button-default uk-button-large form-button",onClick:o[8]||(o[8]=(...n)=>s.approveOnClick&&s.approveOnClick(...n))},[i.approval_foxs?i.approval_fox?b("",!0):(l(),a("span",_t,"Approve(FOX)")):(l(),a("span",kt,"Approve(FOXS)"))])])):(l(),a("div",vt,[t("button",{class:"uk-button uk-button-default uk-button-large form-button",onClick:o[9]||(o[9]=(...n)=>s.connectOnClick&&s.connectOnClick(...n))}," Connect Wallet ")]))])])}const bt=W(P,[["render",gt]]),wt={data(){return{connected:!1,approval_weth:!1,tokenIds:[],cdp:"",weth:r.from("0"),ltv:0,foxs:r.from("0"),weth_format:"",foxs_format:"",bWethWrongRange:!1,bLtvWrongRange:!1,trustLevel:0,maxLTV:0}},computed:{formattedWETH:{get(){return this.weth_format===""?"":this.weth_format},set(e){let o=e.toString();this.weth_format=o,o===""&&(o="0"),this.weth=p(o,"ether")}},formattedLTV:{get(){return this.ltv===""?"":+(this.ltv/100).toFixed(2)},set(e){console.log("set ltv!!",e),this.ltv=+(+e.toFixed(2)*100).toFixed(2)}},formattedFOXS:{get(){return this.foxs_format===""?"":this.foxs_format},set(e){let o=e.toString();this.foxs_format=o,o===""&&(o="0"),this.foxs=p(o,"ether")}}},mounted(){try{this.updateValues(),this.checkAllowance()}catch{}this.emitter.on("metamask-connect-event",e=>{this.connected=e,this.connected&&(this.updateValues(),this.checkAllowance())}),k()!==""&&(this.connected=!0)},methods:{checkAllowance:function(){v("WETH").then(e=>{e!=0&&(this.approval_weth=!0)})},updateValues:function(){z().then(e=>{this.trustLevel=+(e/100).toFixed(2)}),M().then(e=>{this.maxLTV=+(e/100).toFixed(2)}),L().then(e=>{this.tokenIds=e})},connectOnClick:function(){console.log("connected : ",this.connected),!(k()!==""||this.connected)&&F().then(e=>{e?(console.log("metamask successfully connected!"),this.emitter.emit("metamask-connect-event",!0)):(console.log("metamask connection failed!"),this.emitter.emit("metamask-connect-event",!1))})},approveOnClick:async function(){if(!this.approval_weth){this.emitter.emit("loading-event",!0);try{await g("WETH")?this.approval_weth=!0:this.approval_weth=!1}catch{}finally{this.emitter.emit("loading-event",!1)}}},RecollateralizeOnClick:async function(){this.emitter.emit("loading-event",!0);try{const e=await I(this.cdp,this.weth,this.ltv);console.log(e?"recollateralize success!":"recollateralize failed!")}catch{}finally{this.emitter.emit("loading-event",!1)}},changeCDP:function(){D(this.cdp).then(e=>{this.setWETH(e.collateralAmount_),this.ltv=e.ltv_,this.setFOXS(e.shareAmount_)})},setWETH:function(e){this.weth=r.from(e),this.weth_format=w(r.from(e))},setFOXS:function(e){this.foxs=r.from(e),this.foxs_format=w(r.from(e))},updateMaxWethOnClick:async function(){this.updateMaxWETH().then(e=>{this.inputWETH()})},updateMaxLtvOnClick:async function(){this.updateMaxLTV().then(e=>{this.inputLTV()})},updateMaxWETH:async function(){return x(this.cdp,this.ltv).then(e=>{this.setWETH(e.upperBound_)})},updateMaxLTV:async function(){return y(this.cdp,this.weth).then(e=>{this.ltv=e.upperBound_})},inputWETH:async function(e){this.updateFoxs().then(o=>{this.checkRange(e)})},inputLTV:async function(e){this.updateFoxs().then(o=>{this.checkRange(e)})},updateFoxs:async function(){return U(this.cdp,this.weth,this.ltv).then(e=>{console.log("getShareAmountInRecollateralize",e),this.setFOXS(r.from(e))})},checkRange:async function(e){x(this.cdp,this.ltv).then(o=>{let u=r.from(o.upperBound_),c=r.from(o.lowerBound_);this.bWethWrongRange=e!==void 0&&parseInt(e.target.value)<0||this.weth.gt(u)||this.weth.lt(c),console.log(this.bWethWrongRange,"WETH RANGE!!! ",u,c)}),y(this.cdp,this.weth).then(o=>{let u=o.upperBound_,c=o.lowerBound_;this.bLtvWrongRange=e!==void 0&&parseInt(e.target.value)<0||this.ltv>u||this.ltv<c,console.log(this.bLtvWrongRange,"LTV RANGE!!! ",u,c,this.ltv)})}}},xt={class:"uk-width-1-1"},yt={key:0,class:"wallet-outer uk-width-1-1"},Ct=t("div",{class:"wallet-inner"},[t("span",{"uk-icon":"icon: more; ratio: 3"}),t("p",null,"Please connect to wallet")],-1),Vt=[Ct],Tt={class:"uk-width-1-1"},Ot=t("hr",null,null,-1),Wt={class:"uk-inline form-icon"},Lt={"uk-form-custom":"target: > button > span:first-child",style:{"padding-left":"0px","padding-right":"0px"}},Ft=t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon"},[t("span",null,"CDP#")],-1),Rt=["disabled"],St=["value"],Et=t("button",{class:"uk-button uk-button-grey form-button uk-form-width-medium uk-form-large uk-text-left",type:"button",tabindex:"-1",style:{"max-width":"100%"}},[t("span"),t("span",{"uk-icon":"icon: chevron-down",style:{float:"right",position:"relative",right:"95px",top:"17px"}})],-1),Xt=t("div",{class:"wrap"},[t("span",{class:"icon-circle","uk-icon":"icon: arrow-down; ratio: 2;",style:{"margin-left":"-1px"}})],-1),At={class:"uk-inline form-icon"},Bt=t("img",{src:A,style:{width:"20px"}},null,-1),Ht=t("span",null,"FIL",-1),zt=[Bt,Ht],Mt=["disabled"],It={class:"wrap"},Dt={class:"uk-inline"},Ut=t("span",null,"LTV(%)",-1),Pt=[Ut],Nt=["disabled"],Gt={key:0,class:"description"},Kt=t("span",{style:{"font-weight":"bold",color:"red"}},"WRONG VALUE!",-1),jt=[Kt],qt={key:1,class:"description"},Jt=t("span",{style:{"font-weight":"bold"}},"MAX LTV:",-1),Qt=t("hr",{class:"custom-divider-vertical"},null,-1),Yt={class:"description"},Zt=t("span",{style:{"font-weight":"bold"}},"TRUST LEVEL:",-1),$t=t("div",{class:"wrap"},[t("span",{class:"icon-circle","uk-icon":"icon: arrow-down; ratio: 2;",style:{"margin-left":"-1px"}})],-1),te={class:"uk-inline form-icon"},ee=t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon"},[t("img",{src:X,style:{width:"20px"}}),t("span",null,"FOXS")],-1),oe=t("hr",null,null,-1),ne={key:2},se={key:3},ie={key:4};function le(e,o,u,c,i,s){return l(),a("div",xt,[i.connected?b("",!0):(l(),a("div",yt,Vt)),t("div",Tt,[Ot,t("div",Wt,[t("div",Lt,[Ft,d(t("select",{"onUpdate:modelValue":o[0]||(o[0]=n=>i.cdp=n),"aria-label":"Custom controls",class:"form-button uk-form-width-medium uk-form-large",onChange:o[1]||(o[1]=(...n)=>s.changeCDP&&s.changeCDP(...n)),disabled:!i.connected},[(l(!0),a(S,null,E(i.tokenIds,n=>(l(),a("option",{key:n,value:n},m(n),9,St))),128))],40,Rt),[[R,i.cdp]]),Et])]),Xt,t("div",At,[t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon",onClick:o[2]||(o[2]=n=>s.updateMaxWethOnClick())},zt),d(t("input",{class:C(["uk-input input-form uk-form-width-medium uk-form-large",{wrong:i.bWethWrongRange}]),type:"number",min:"0","onUpdate:modelValue":o[3]||(o[3]=n=>s.formattedWETH=n),onInput:o[4]||(o[4]=n=>s.inputWETH(n)),disabled:i.cdp===""},null,42,Mt),[[h,s.formattedWETH]])]),t("div",It,[t("div",Dt,[t("a",{class:"uk-form-icon uk-form-icon-flip input-form-icon",onClick:o[5]||(o[5]=n=>s.updateMaxLtvOnClick())},Pt),d(t("input",{class:C(["uk-input input-form uk-form-width-medium uk-form-large",{wrong:i.bLtvWrongRange}]),type:"number","onUpdate:modelValue":o[6]||(o[6]=n=>s.formattedLTV=n),onInput:o[7]||(o[7]=n=>s.inputLTV(n)),disabled:i.cdp===""},null,42,Nt),[[h,s.formattedLTV]])])]),i.bWethWrongRange||i.bLtvWrongRange?(l(),a("div",Gt,jt)):(l(),a("div",qt,[Jt,V(" "+m(this.maxLTV)+"% ",1)])),Qt,t("div",Yt,[Zt,V(" "+m(this.trustLevel)+"% ",1)]),$t,t("div",te,[ee,d(t("input",{readonly:"",class:"uk-input result-form uk-form-width-medium uk-form-large",type:"number","onUpdate:modelValue":o[8]||(o[8]=n=>s.formattedFOXS=n)},null,512),[[h,s.formattedFOXS]])]),oe,i.approval_weth?(l(),a("div",ne,[t("button",{class:"uk-button uk-button-default uk-button-large form-button",onClick:o[9]||(o[9]=(...n)=>s.RecollateralizeOnClick&&s.RecollateralizeOnClick(...n))}," Recollateralize ")])):i.connected?(l(),a("div",se,[t("button",{class:"uk-button uk-button-default uk-button-large form-button",onClick:o[10]||(o[10]=(...n)=>s.approveOnClick&&s.approveOnClick(...n))}," Approve(WETH) ")])):(l(),a("div",ie,[t("button",{class:"uk-button uk-button-default uk-button-large form-button",onClick:o[11]||(o[11]=(...n)=>s.connectOnClick&&s.connectOnClick(...n))}," Connect Wallet ")]))])])}const ae=W(wt,[["render",le]]),re={class:"width-1-1-medium"},ce={class:"uk-card uk-card-default"},ue={class:"uk-flex-center","uk-tab":"","data-uk-tab":"{connect:'#buyback-tab-contents'}"},de={class:"uk-active"},he={id:"buyback-tab-contents",class:"uk-switcher"},me={__name:"BuybackView",setup(e){let o=T(0),u=T(0),c=()=>{o.value++},i=()=>{u.value++};return(s,n)=>(l(),a("div",re,[t("div",ce,[t("div",null,[t("ul",ue,[t("li",de,[t("a",{onClick:n[0]||(n[0]=(..._)=>f(c)&&f(c)(..._))},"Buyback")]),t("li",null,[t("a",{onClick:n[1]||(n[1]=(..._)=>f(i)&&f(i)(..._))},"Recollateralize")])]),t("ul",he,[t("li",null,[O(bt)]),t("li",null,[O(ae)])])])])]))}};export{me as default};
